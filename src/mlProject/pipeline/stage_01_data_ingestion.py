from mlProject.config.configuration import ConfigurationManager
from mlProject.components.data_ingestion import DataIngestion
from mlProject import logger

# ðŸ à¦¸à§à¦Ÿà§‡à¦œà§‡à¦° à¦¨à¦¾à¦® à¦¨à¦¿à¦°à§à¦§à¦¾à¦°à¦£ à¦•à¦°à¦¾ à¦¹à§Ÿà§‡à¦›à§‡ - à¦²à¦—à¦¿à¦‚ à¦“ à¦Ÿà§à¦°à§à¦¯à¦¾à¦•à¦¿à¦‚-à¦à¦° à¦¸à§à¦¬à¦¿à¦§à¦¾à¦°à§à¦¥à§‡
STAGE_NAME = "Data Ingestion stage"

# ðŸ› ï¸ Data Ingestion à¦¸à§à¦Ÿà§‡à¦œà§‡à¦° à¦Ÿà§à¦°à§‡à¦¨à¦¿à¦‚ à¦ªà¦¾à¦‡à¦ªà¦²à¦¾à¦‡à¦¨ à¦•à§à¦²à¦¾à¦¸
class DataIngestionTrainingPipeline:
    def __init__(self):
        # ðŸš§ à¦­à¦¬à¦¿à¦·à§à¦¯à¦¤à§‡à¦° à¦œà¦¨à§à¦¯ à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤: à¦à¦–à¦¾à¦¨à§‡ à¦‡à¦¨à¦¿à¦¶à¦¿à§Ÿà¦¾à¦²à¦¾à¦‡à¦œà§‡à¦¶à¦¨ à¦•à§‹à¦¡ à¦†à¦¸à¦¬à§‡
        pass
    def main(self):
        # ðŸ› ï¸ à¦•à¦¨à¦«à¦¿à¦—à¦¾à¦°à§‡à¦¶à¦¨ à¦®à§à¦¯à¦¾à¦¨à§‡à¦œà¦¾à¦° à¦•à¦² à¦•à¦°à§‡ à¦•à¦¨à¦«à¦¿à¦— à¦…à¦¬à¦œà§‡à¦•à§à¦Ÿ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡
        config = ConfigurationManager()

        # ðŸ“¦ à¦¡à§‡à¦Ÿà¦¾ à¦‡à¦¨à¦œà§‡à¦¶à¦¨ à¦¸à¦‚à¦•à§à¦°à¦¾à¦¨à§à¦¤ à¦•à¦¨à¦«à¦¿à¦— à¦¸à¦‚à¦—à§à¦°à¦¹
        data_ingestion_config = config.get_data_ingestion_config()

        # ðŸ½ï¸ DataIngestion à¦…à¦¬à¦œà§‡à¦•à§à¦Ÿ à¦¤à§ˆà¦°à¦¿
        data_ingestion = DataIngestion(config=data_ingestion_config)

        # ðŸŒ à¦¡à§‡à¦Ÿà¦¾ à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡
        data_ingestion.download_file()

        # ðŸ“‚ à¦¡à§‡à¦Ÿà¦¾ à¦†à¦¨à¦œà¦¿à¦ª à¦•à¦°à§‡ à¦à¦•à§à¦¸à¦Ÿà§à¦°à¦¾à¦•à§à¦Ÿ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡
        data_ingestion.extract_zip_file()


# ðŸ§  à¦®à§‡à¦‡à¦¨ à¦«à¦¾à¦‚à¦¶à¦¨: à¦¯à¦–à¦¨ à¦¸à§à¦•à§à¦°à¦¿à¦ªà§à¦Ÿ à¦¸à¦°à¦¾à¦¸à¦°à¦¿ à¦°à¦¾à¦¨ à¦¹à¦¬à§‡ à¦¤à¦–à¦¨à¦‡ à¦¨à¦¿à¦šà§‡à¦° à¦…à¦‚à¦¶à¦Ÿà¦¿ à¦šà¦²à¦¬à§‡
if __name__ == '__main__':
    try:
        # ðŸš€ à¦¸à§à¦Ÿà§‡à¦œ à¦¶à§à¦°à§ à¦¹à¦“à§Ÿà¦¾à¦° à¦²à¦—
        logger.info(f">>>>>> stage {STAGE_NAME} started <<<<<<")

        # ðŸ§± DataIngestionTrainingPipeline à¦…à¦¬à¦œà§‡à¦•à§à¦Ÿ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾
        obj = DataIngestionTrainingPipeline()

        # ðŸ” à¦ªà¦¾à¦‡à¦ªà¦²à¦¾à¦‡à¦¨à§‡à¦° à¦®à§‚à¦² à¦•à¦¾à¦œ à¦šà¦¾à¦²à¦¾à¦¨à§‹ (main() à¦«à¦¾à¦‚à¦¶à¦¨ à¦à¦–à¦¾à¦¨à§‡ à¦¡à¦¿à¦«à¦¾à¦‡à¦¨ à¦¥à¦¾à¦•à¦¤à§‡ à¦¹à¦¬à§‡)
        obj.main()

        # âœ… à¦¸à§à¦Ÿà§‡à¦œ à¦¸à¦«à¦²à¦­à¦¾à¦¬à§‡ à¦¶à§‡à¦· à¦¹à¦²à§‡ à¦²à¦—
        logger.info(f">>>>>> stage {STAGE_NAME} completed <<<<<<\n\nx==========x")

    except Exception as e:
        # âŒ à¦•à§‹à¦¨ à¦à¦°à¦° à¦¹à¦²à§‡ à¦¸à§‡à¦Ÿà¦¾à¦° à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤ à¦²à¦— à¦•à¦°à¦¾ à¦¹à¦¬à§‡
        logger.exception(e)
        raise e
